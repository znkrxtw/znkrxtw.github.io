<!DOCTYPE html>
<html lang="en_US">
<head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="src/css/all.css">
    <link rel="stylesheet" href="src/css/body.css">
    <link rel="stylesheet" href="src/css/footer.css">
    <link rel="stylesheet" href="src/css/header.css">
    <link rel="stylesheet" href="src/css/fonts.css">
    <script src="src/js/three.js"></script>
    <title>Stoni</title>
</head>

<body>

<header class="header">
    <div class="header-container">STON STREAM</div>
    <nav class="navigation">
        <div class="button" data-tab="tab1">SFX</div>
        <div class="button" data-tab="tab2">Overlay</div>
        <div class="button" data-tab="tab3">Voices</div>
        <div class="button" data-tab="tab4">I dont know</div>
    </nav>
</header>

<div class="content-container">
    <div id="main-content" class="tab-content active">
        <div class="loading">Loading content...</div>
    </div>
</div>

<section class="content">
    <div class="mainbox">
        <div id="myCanvas" class="box3d">
            <script src="src/js/scene.js"></script>
        </div>
    </div>

</section>

<script>
    // Define content files for each tab
    const contentFiles = {
        'tab1': 'src/content/content1.html',
        'tab2': 'src/content/content2.html',
        'tab3': 'src/content/content3.html',
        'tab4': 'src/content/content4.html'
    };

    // Cache for loaded content
    const contentCache = {};

    // Get elements
    const tabButtons = document.querySelectorAll('.button[data-tab]');
    const mainContent = document.getElementById('main-content');

    // Function to load content from file
    async function loadContent(tabId) {
        // Check if content is already cached
        if (contentCache[tabId]) {
            return contentCache[tabId];
        }

        try {
            const response = await fetch(contentFiles[tabId]);
            if (!response.ok) {
                throwError(tabId, response.statusText);
            }
            const html = await response.text();
            contentCache[tabId] = html; // Cache the content
            return html;
        } catch (error) {
            throwError(tabId, error);
        }
    }

    function throwError(tabId, error) {
        console.error(`There was an error error ${contentFiles[tabId]}`, error);
        return `<div class="error">
                        <h2>Content Not Found</h2>
                        <p>Sorry, we couldn't load the content for this section.</p>
                        <p>Please make sure the file <strong>${contentFiles[tabId]}</strong> exists.</p>
                    </div>`;
    }

    // Function to switch tab
    async function switchTab(tabId) {
        // Show loading state
        mainContent.innerHTML = '<div class="loading">Loading content...</div>';

        // Remove active class from all buttons
        tabButtons.forEach(btn => btn.classList.remove('active'));

        // Add active class to clicked button
        const activeButton = document.querySelector(`[data-tab="${tabId}"]`);
        if (activeButton) {
            activeButton.classList.add('active');
        }

        // Load and display content
        mainContent.innerHTML = await loadContent(tabId);

        // Trigger fade-in animation
        mainContent.style.opacity = '0';
        setTimeout(() => {
            mainContent.style.opacity = '1';
        }, 50);
    }

    // Add click event listeners
    tabButtons.forEach(button => {
        button.addEventListener('click', () => {
            const tabId = button.getAttribute('data-tab');
            switchTab(tabId);
        });
    });

    // Load initial content
    switchTab('tab1');

    // Optional: Add keyboard navigation
    document.addEventListener('keydown', (e) => {
        if (e.key >= '1' && e.key <= '4') {
            const index = parseInt(e.key) - 1;
            if (tabButtons[index]) {
                const tabId = tabButtons[index].getAttribute('data-tab');
                switchTab(tabId);
            }
        }
    });
</script>

<footer>
    <div class="footer"></div>
</footer>

</body>
</html>